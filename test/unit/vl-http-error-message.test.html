<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <script src="../../node_modules/@webcomponents/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="../../node_modules/web-component-tester/browser.js"></script>

  <script type="module" src="../../src/vl-http-error-message.src.js"></script>
</head>

<body>
  <test-fixture id="vl-http-error-message-fixture">
    <template>
      <vl-http-error-message data-vl-title="Titel" data-vl-image="afbeelding-url" data-vl-image-alt="afbeelding-alt">
        <p slot="text">Beschrijving</p>
        <div slot="actions">Knopjes</div>
      </vl-http-error-message>
    </template>
  </test-fixture>

  <test-fixture id="vl-http-404-message-fixture">
    <template>
      <vl-http-404-message></vl-http-404-message>
    </template>
  </test-fixture>

  <script type="module">
    import { awaitUntil } from 'vl-ui-core/vl-core';

    suite('vl-http-error-message', () => {
      const should = chai.should();

      test('Een vl-http-error-message toont alle geconfigureerde tekst, afbeeldingen en acties', () => {
        const message = fixture('vl-http-error-message-fixture');
        const shadowRoot = message.shadowRoot;

        shadowRoot.querySelector('#title').textContent.should.equal('Titel');
        shadowRoot.querySelector('#text').textContent.should.equal('Beschrijving');
        shadowRoot.querySelector('#actions').textContent.should.equal('Knopjes');

        const smallImage = shadowRoot.querySelector('#image-small');
        smallImage.getAttribute('src').should.equal('afbeelding-url');
        smallImage.alt.should.equal('afbeelding-alt');

        const normalImage = shadowRoot.querySelector('#image-normal');
        normalImage.getAttribute('src').should.equal('afbeelding-url');
        normalImage.alt.should.equal('afbeelding-alt');
      });
    });

    suite('vl-http-404-message', () => {
      const should = chai.should();

      test('Een vl-http-404-message configureert de juiste tekst, afbeeldingen en acties by default', () => {
        const message = fixture('vl-http-404-message-fixture');
        const shadowRoot = message.shadowRoot;

        shadowRoot.querySelector('#title').textContent.should.equal('Oeps, die pagina vonden we niet terug');
        shadowRoot.querySelector('#text').textContent.should.equal('De pagina die u zoekt, vonden we niet terug.');

        const action = shadowRoot.querySelector('#actions a');
        action.getAttribute('href').should.equal('/');
        action.textContent.should.equal('Terug naar de startpagina');

        const smallImage = shadowRoot.querySelector('#image-small');
        smallImage.getAttribute('src').should.equal('https://cdn.milieuinfo.be/http-error-message-assets/LATEST/img/page-not-found.svg');
        smallImage.alt.should.equal('Pagina niet gevonden');

        const normalImage = shadowRoot.querySelector('#image-normal');
        normalImage.getAttribute('src').should.equal('https://cdn.milieuinfo.be/http-error-message-assets/LATEST/img/page-not-found.svg');
        normalImage.alt.should.equal('Pagina niet gevonden');
      });

      test('Een vl-http-404-message configureert de juiste tekst, afbeeldingen en acties na overschrijving van de default waarden', () => {
        const message = fixture('vl-http-404-message-fixture');
        message.dataset.vlTitle = 'Foo';
        message.dataset.vlImage = 'Bar';
        message.dataset.vlImageAlt = 'foobar';

        const textSlot = document.createElement('div');
        textSlot.slot = 'text';
        textSlot.textContent = 'hello world';
        message.appendChild(textSlot);

        const actionsSlot = document.createElement('div');
        actionsSlot.slot = 'actions';
        actionsSlot.textContent = 'moo';
        message.appendChild(actionsSlot);

        const shadowRoot = message.shadowRoot;
        const smallImage = shadowRoot.querySelector('#image-small');
        const normalImage = shadowRoot.querySelector('#image-normal');

        return awaitUntil(() => shadowRoot.querySelector('#title').textContent === 'Foo' &&
            shadowRoot.querySelector('#text').textContent === 'hello world' &&
            shadowRoot.querySelector('#actions').textContent === 'moo' &&
            smallImage.getAttribute('src') === 'Bar' &&
            smallImage.alt === 'foobar' &&
            normalImage.getAttribute('src') === 'Bar' &&
            normalImage.alt === 'foobar'
        );
      });
    });
  </script>
</body>

</html>
